<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Marcela ðŸ’‹</title>

<style>
  :root {
    --bg-header:#111824;
    --bg-chat:#e8dfd7;
    --user-bubble:#dcf8c6;
    --bot-bubble:#ffffff;
  }

  /* ======= RESET ======= */
  body, html {
    margin:0;
    padding:0;
    height:100%;
    width:100%;
    overflow:hidden;
    background:#0d0f14;
    font-family: Arial, sans-serif;
  }

  /* ======= APP PRINCIPAL ======= */
  .app {
    display:flex;
    flex-direction:column;
    height:100dvh;   /* <-- ALTURA REAL DO CELULAR */
    min-height:100dvh;
    width:100vw;
    overflow:hidden;
  }

  /* ====== HEADER ====== */
  .header {
    background:var(--bg-header);
    height:70px;
    min-height:70px;
    display:flex;
    align-items:center;
    gap:12px;
    padding:0 16px;
    color:white;
    border-bottom:1px solid #1e2633;
    flex-shrink:0;
  }

  .header img {
    width:50px;
    height:50px;
    border-radius:50%;
    object-fit:cover;
  }

  /* ====== CHAT ====== */
  .chat {
    flex:1;
    height:calc(100dvh - 70px - 70px); /* header + footer */
    background:var(--bg-chat);
    overflow-y:auto;
    display:flex;
    justify-content:flex-start;
  }

  .inner-chat {
    display:flex;
    flex-direction:column;
    width:100%;
    height:auto;
    padding:20px; /* evita bolha colada no topo */
    box-sizing:border-box;
    margin:0 auto;
  }

  /* Desktop centralizado */
  @media (min-width:900px) {
    .inner-chat {
      max-width:780px;
    }
  }

  .chat::-webkit-scrollbar {
    width:6px;
  }
  .chat::-webkit-scrollbar-thumb {
    background:#b6b6b6;
    border-radius:50px;
  }

  /* ====== BOLHAS ====== */
  .bubble {
    max-width:85%;
    padding:11px 15px;
    border-radius:14px;
    margin-bottom:12px;
    white-space:pre-wrap;
    font-size:1rem;
    line-height:1.45;
    word-wrap:break-word;
  }

  .from-user { background:var(--user-bubble); align-self:flex-end; }
  .from-bot  { background:var(--bot-bubble);  align-self:flex-start; }

  /* ====== TYPING ====== */
  .typing {
    background:white;
    padding:11px 14px;
    border-radius:14px;
    display:flex;
    gap:4px;
    align-self:flex-start;
  }

  .dot {
    width:8px;
    height:8px;
    border-radius:50%;
    background:#aaa;
    animation:pulse 1s infinite ease-in-out;
  }
  .dot:nth-child(2){ animation-delay:.2s }
  .dot:nth-child(3){ animation-delay:.4s }

  @keyframes pulse {
    0%{ transform:scale(1); opacity:.4 }
    50%{ transform:scale(1.5); opacity:1 }
    100%{ transform:scale(1); opacity:.4 }
  }

  /* ====== FOOTER ====== */
  .footer {
    background:#f0f0f0;
    padding:10px;
    display:flex;
    gap:8px;
    align-items:center;
    border-top:1px solid #ccc;
    min-height:70px;
    flex-shrink:0;
  }

  .footer input {
    flex:1;
    height:50px;
    border-radius:999px;
    border:1px solid #ccc;
    padding:0 18px;
    font-size:1rem;
  }

  .footer button {
    height:50px;
    padding:0 22px;
    border-radius:999px;
    border:none;
    background:#ff4f87;
    color:white;
    font-weight:bold;
    font-size:1rem;
    cursor:pointer;
  }

</style>
</head>

<body>

<div class="app">

  <!-- HEADER -->
  <div class="header">
    <img src="download.png">
    <div>
      <div style="font-size:18px;font-weight:600;">Marcela ðŸ’‹</div>
      <div id="status" style="font-size:13px;opacity:.8;">digitando...</div>
    </div>
  </div>

  <!-- CHAT -->
  <div class="chat" id="chat">
    <div class="inner-chat" id="innerChat"></div>
  </div>

  <!-- FOOTER -->
  <div class="footer">
    <input id="input" placeholder="Digite..." autocomplete="off">
    <button id="send">Enviar</button>
  </div>

</div>

<script>
/* ========= SUA API KEY ========= */
const API_KEY = "AIzaSyBYlGjOt-8z9JBJhaOXDgMDM277uop2JeM";
const MODEL   = "models/gemini-flash-latest";

/* ========= ELEMENTOS ========= */
const chat = document.getElementById("chat");
const innerChat = document.getElementById("innerChat");
const input = document.getElementById("input");
const send  = document.getElementById("send");
const statusText = document.getElementById("status");

/* ========= MEMÃ“RIA ========= */
let conversation = [
  {
    role:"user",
    content:`VocÃª Ã© Marcela ðŸ’‹.
Responda com carinho, seduÃ§Ã£o leve e emojis.
Nunca explÃ­cita.`
  }
];

/* ========= FUNÃ‡Ã•ES ========= */
function addBubble(text, from){
  const d = document.createElement("div");
  d.className = "bubble " + (from==="user"?"from-user":"from-bot");
  d.textContent = text;
  innerChat.appendChild(d);
  chat.scrollTop = chat.scrollHeight;
}

function addTyping(){
  const t = document.createElement("div");
  t.className = "typing";
  t.id = "typingBubble";
  t.innerHTML = `
    <div class="dot"></div>
    <div class="dot"></div>
    <div class="dot"></div>
  `;
  innerChat.appendChild(t);
  chat.scrollTop = chat.scrollHeight;
}

function removeTyping(){
  const t = document.getElementById("typingBubble");
  if(t) t.remove();
}

/* ======= CHAMADA Ã€ GEMINI ======= */
async function askGemini(){
  const payload = conversation.map(c => `${c.role}: ${c.content}`).join("\n");

  const body = {
    contents:[ { parts:[ { text:payload } ] } ]
  };

  const res = await fetch(
    `https://generativelanguage.googleapis.com/v1beta/${MODEL}:generateContent?key=${API_KEY}`,
    {
      method:"POST",
      headers:{ "Content-Type":"application/json" },
      body:JSON.stringify(body)
    }
  );

  const data = await res.json();

  try {
    return data.candidates[0].content.parts[0].text;
  } catch {
    return "Fiquei atÃ© sem palavras agora ðŸ˜…ðŸ’‹";
  }
}

/* ========= ENVIO ========= */
async function handleSend(){
  const text = input.value.trim();
  if(!text) return;

  addBubble(text,"user");
  conversation.push({ role:"user", content:text });
  input.value = "";

  addTyping();
  statusText.textContent = "digitandoâ€¦";

  const reply = await askGemini();

  removeTyping();
  statusText.textContent = "online agora";

  addBubble(reply,"bot");
  conversation.push({ role:"assistant", content:reply });
}

send.onclick = handleSend;
input.onkeydown = e => { if(e.key==="Enter") handleSend(); };

/* ========= MENSAGEM INICIAL ========= */
setTimeout(()=>{
  const msg = "Oiâ€¦ tava pensando em vocÃª ðŸ‘€ðŸ’‹";
  addBubble(msg,"bot");
  conversation.push({ role:"assistant", content:msg });
},500);

</script>

</body>
</html>
